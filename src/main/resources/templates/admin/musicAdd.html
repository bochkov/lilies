{% extends 'admin/index' %}

{% block a_music %}active{% endblock %}

{% block cmd %}
{% if music.id is null %}
<h3>Добавление партитуры</h3>
{% else %}
<h3>Редактирование партитуры</h3>
{% endif %}
{% endblock %}

{% block content %}
<div class="col-md-7">
<form method="POST" action="/admin/music/save/" enctype="multipart/form-data" class="form-horizontal">

    <div class="form-group">
        <label for="name" class="col-sm-2 control-label">Название</label>
        <div class="col-sm-10">
            <input type="text" name="name" class="form-control" id="name" value="{{music.name}}" />
        </div>
    </div>

    <div class="form-group">
        <label for="subname" class="col-sm-2 control-label">подИмя</label>
        <div class="col-sm-10">
            <input class="form-control" id="subname" type="text" name="subname" value="{{music.subname}}" />
        </div>
    </div>

    <div class="form-group">
        <label for="composer-select" class="col-sm-2 control-label">Композиторы</label>
        <div class="col-sm-10">
            <select name="composer" class="col-sm-10" id="composer-select" multiple data-placeholder="Композиторы">
                {% for author in authors %}
                {% set selected = music.composer contains author %}
                <option value="{{author.id}}" {% if selected %}selected{% endif %}>{{author.print}}</option>
                {% endfor %}
            </select>
        </div>
    </div>

    <div class="form-group">
        <label for="writer-select" class="col-sm-2 control-label">Авторы</label>
        <div class="col-sm-10">
            <select name="writer" class="col-sm-10" id="writer-select" multiple data-placeholder="Авторы">
                {% for author in authors %}
                {% set selected = music.writer contains author %}
                <option value="{{author.id}}" {% if selected %}selected{% endif %}>{{author.print}}</option>
                {% endfor %}
            </select>
        </div>
    </div>

    <div class="form-group">
        <label for="difficulty-select" class="col-sm-2 control-label">Сложность</label>
        <div class="col-sm-10">
            <select name="difficulty" class="col-sm-10" id="difficulty-select" data-placeholder="Сложность">
                {% for diff in difficulties %}
                {% set selected = music.difficulty equals diff %}
                <option value="{{diff.rating}}" {% if selected %}selected{% endif %}>{{ diff.print }}</option>
                {% endfor %}
            </select>
        </div>
    </div>

    <div class="form-group">
        <label for="instrument-select" class="col-sm-2 control-label">Инструменты</label>
        <div class="col-sm-10">
            <select name="instrument" class="col-sm-10" multiple id="instrument-select" data-placeholder="Инструменты">
                {% for instrument in instruments %}
                {% set selected = music.instrument contains instrument %}
                <option value="{{instrument.slug}}" {% if selected %}selected{% endif %}>{{instrument.print}}</option>
                {% endfor %}
            </select>
        </div>
    </div>

    {% if music.id is null %}
    <div class="form-group">
        <label for="srcfile" class="col-sm-2 control-label">ly-файл</label>
        <div class="col-sm-10">
            <input type="file" name="src_file" id="srcfile" />
        </div>
    </div>
    {% endif %}

    <button class="col-sm-offset-2 btn btn-primary" type="submit"><i class="fa fa-save"></i> Сохранить</button>
</form>
</div>
{% endblock %}

{% block custom_js %}
<script>
    $(function() {
        $("#composer-select").chosen();
        $("#writer-select").chosen();
        $("#difficulty-select").chosen();
        $("#instrument-select").chosen();
    })
</script>
{% endblock %}